<!DOCTYPE html>
<html>
    <head>
        <title>Websocket Based HTML5 IRC Client</title>
    </head>
    <body style="font-family:  Helvetica, Arial, sans-serif; font-size: 24pt" bgcolor="#151515">
        <p style="color:#FFC000;width: 800px">Websocket Based HTML5 IRC Client</p>
        <canvas id="IrcCanvas" width="1200" height="500"></canvas>
        <form id="conversation" onsubmit="DispatchText()" action="javascript:void(0);">
            <input type="text" id="message" name="message" autocomplete="off" style="width:700px" />
            <input type="submit" id="sub" name="sub" value="Send" style="width:90px" />
        </form>
        <script type="text/javascript">
		var canvas = document.getElementById('IrcCanvas');
		var context = canvas.getContext('2d');
		var ws = new WebSocket("ws://127.0.0.1:8888/websocket");
		var x = 15;
		var y = 15;
		ws.onmessage = function(evt)
		{
			var p = JSON.parse(evt.data);
			var line = p.friendly_time + ' | ' + p.nick + ' | ' + p.args[1]
			context.font = '12pt Helvetica, Arial, sans-serif';
			context.fillStyle = 'white';
			context.fillText(line, x, y);
			y = y + 15;
		}
		function DispatchText(){
			var userInput = document.getElementById("message").value;
			document.getElementById("message").value = "";
			ws.send(userInput);
		}
        </script>
    </body>
</html>
